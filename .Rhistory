ggplot(aes(ca_IsActiveMember,n,label= prop,
fill=ca_IsActiveMember)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* HasCrCard
plot_HCre <-dat %>%
count(ca_HasCrCard) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_HasCrCard,n,label= prop,fill= ca_HasCrCard)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* Visualizaci칩n
ggarrange(plot_Gender, plot_Act, plot_HCre,
ncol = 3, nrow = 1)
##* Gender
plot_Gender <-dat %>%
count(ca_Gender) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_Gender,n,label= prop,fill= ca_Gender)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* IsActiveMember
plot_Act <-dat %>%
count(ca_IsActiveMember) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_IsActiveMember,n,label= prop,
fill=ca_IsActiveMember)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* HasCrCard
plot_HCre <-dat %>%
count(ca_HasCrCard) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_HasCrCard,n,label= prop,fill= ca_HasCrCard)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* Visualizaci칩n
ggarrange(plot_Gender, plot_Act, plot_HCre,
ncol = 3, nrow = 1)
##* Gender
plot_Gender <-dat %>%
count(ca_Gender) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_Gender,n,label= prop,fill= ca_Gender)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
theme(legend.position='none')+
scale_fill_npg()
##* IsActiveMember
plot_Act <-dat %>%
count(ca_IsActiveMember) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_IsActiveMember,n,label= prop,
fill=ca_IsActiveMember)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()  +
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* HasCrCard
plot_HCre <-dat %>%
count(ca_HasCrCard) %>%
mutate(prop = percent(prop.table(n))) %>%
ggplot(aes(ca_HasCrCard,n,label= prop,fill= ca_HasCrCard)) +
geom_col(color="black")+
geom_text(check_overlap = TRUE,
position = position_stack(vjust = 0.5),
size=3)+
theme_bw()+
scale_fill_manual("", values = c("0" = "#d62727",
"1" = "#2ca02c"))+
theme(legend.position='none')
##* Visualizaci칩n
ggarrange(plot_Gender, plot_Act, plot_HCre,
ncol = 3, nrow = 1)
##* cu_EstimatedSalary
g1 <- ggdensity(dat$cu_EstimatedSalary, fill = "lightgray")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="EstimatedSalary") +
scale_fill_d3()
g2 <- ggqqplot(dat$cu_EstimatedSalary)
g1;g2
##* cu_Tenure
g1 <- ggdensity(dat$cu_Tenure, fill = "lightgray")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="Tenure")
g2 <- ggqqplot(dat$cu_Tenure)
g1;g2
##* cu_NumOfProducts
g1 <- ggdensity(dat$cu_NumOfProducts, fill = "lightgray")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="NumOfProducts")
g2 <- ggqqplot(dat$cu_NumOfProducts)
g1;g2
##* cu_EstimatedSalary
g1 <- ggdensity(dat$cu_EstimatedSalary, fill = "#d62727")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="EstimatedSalary")
g2 <- ggqqplot(dat$cu_EstimatedSalary)
g1;g2
##* cu_Tenure
g1 <- ggdensity(dat$cu_Tenure, fill = "lightgray")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="Tenure")
g2 <- ggqqplot(dat$cu_Tenure)
g1;g2
##* cu_NumOfProducts
g1 <- ggdensity(dat$cu_NumOfProducts, fill = "lightgray")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="NumOfProducts")
g2 <- ggqqplot(dat$cu_NumOfProducts)
g1;g2
##* cu_EstimatedSalary
g1 <- ggdensity(dat$cu_EstimatedSalary, fill = "#d62727")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="EstimatedSalary")
g2 <- ggqqplot(dat$cu_EstimatedSalary)
g1;g2
##* cu_Tenure
g1 <- ggdensity(dat$cu_Tenure, fill = "#9467bd")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="Tenure")
g2 <- ggqqplot(dat$cu_Tenure)
g1;g2
##* cu_NumOfProducts
g1 <- ggdensity(dat$cu_NumOfProducts, fill = "#8c564b")+
stat_overlay_normal_density(color = "red", linetype = "dashed") +
labs(x ="NumOfProducts")
g2 <- ggqqplot(dat$cu_NumOfProducts)
g1;g2
##* cu_CreditScore:
g1 <- ggdensity(dat$cu_CreditScore, fill = "#1f77b4")+
stat_overlay_normal_density(color = "red", linetype = "dashed")+
labs(x ="CreditScore")
g2 <- ggqqplot(dat$cu_CreditScore)
g1;g2
##* cu_Age
g1 <- ggdensity(dat$cu_Age, fill = "#ff7f0e")+
stat_overlay_normal_density(color = "red", linetype = "dashed")+
labs(x ="Age")
g2 <- ggqqplot(dat$cu_Age)
g1;g2
##* cu_Balance
g1 <- ggdensity(dat$cu_Balance, fill = "#2ca02c")+
stat_overlay_normal_density(color = "red", linetype = "dashed")+
labs(x ="Balance")
g2 <- ggqqplot(dat$cu_Balance)
g1;g2
##* cu_Age
##* Para identificar outliers y removerlos (la gr치fica previa nos permite identificar
##* Que solo existen outliers superiores, por lo que se puede filtrar respecto al menor
##* de ellos):
out <- as.numeric(min (boxplot(dat$cu_Age)$out) )
out <-dat %>%
filter(cu_Age < out)
g1 <- ggdensity(out$cu_Age, fill = "#ff7f0e")+
stat_overlay_normal_density(color = "red", linetype = "dashed")+
labs(x ="Age")
g2 <- ggqqplot(out$cu_Age)
g1;g2
ks.test(out$cu_Age,"pnorm")
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1)
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1)+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot(width= 3)+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1)+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot(width= 1)+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1)+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot(width= 5)+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1)+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1)+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1, color="red")+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
## Grafica
##* Box
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')+
scale_fill_d3()
##* Density
dat_long %>%
select(variable,value) %>%
ggplot(aes(value,group=variable,fill=variable, alpha=0.7))+
geom_density(kernel = "gaussian")+
geom_vline(data = dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(xintercept = mean))+
facet_wrap(.~variable, scales = "free")+
theme(legend.position='none',axis.text.x = element_text(angle = 90))+
scale_fill_d3()
##* Tablas
dat %>%
select(starts_with("cu")) %>%
describe()
dat %>%
select(starts_with("cu")) %>%
summary.data.frame()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1, color="red")+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
dat_long %>%
select(variable,value) %>%
ggplot(aes(value,group=variable,fill=variable, alpha=0.7))+
geom_density(kernel = "gaussian")+
geom_vline(data = dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(xintercept = mean))+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none',axis.text.x = element_text(angle = 90))+
scale_fill_d3()
dat_long %>%
filter(variable = "cu_EstimatedSalary")
dat_long %>%
filter(variable == "cu_EstimatedSalary") %>%
select(variable,value) %>%
ggplot(aes(value,group=variable,fill=variable, alpha=0.7))+
geom_density(kernel = "gaussian")+
geom_vline(data = dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(xintercept = mean))+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none',axis.text.x = element_text(angle = 90))+
scale_fill_d3()
dat_long %>%
filter(variable == "cu_EstimatedSalary") %>%
select(variable,value) %>%
ggplot(aes(value,group=variable,fill=variable, alpha=0.7))+
geom_density(kernel = "gaussian")+
dat_long
dat_long
dat_long %>%
pivot_wider(ca_Geography)
dat_long %>%
pivot_wider(names_from = ca_Geography, values_from = value)
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) %>%
geom_density(kernel = "gaussian")
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) +
geom_density(kernel = "gaussian")
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(cu_EstimatedSalary) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))
dat %>%
group_by(cu_EstimatedSalary) %>%
summarise(mean= mean(cu_EstimatedSalary))
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean), color=ca_Geography)
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean), color=dat$ca_Geography)
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
theme(legend.position='none',axis.text.x = element_text(angle = 90))+
scale_fill_d3()
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.7)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
theme(legend.position='none',axis.text.x = element_text(angle = 90))+
scale_fill_d3()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1, color="red")+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
dat_long %>%
filter(variable == "cu_EstimatedSalary") %>%
select(variable,value) %>%
ggplot(aes(value,group=variable,fill=variable, alpha=0.7))+
geom_density(kernel = "gaussian")
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.7)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
facet_grid(.~ca_Geography)
theme(legend.position='none',axis.text.x = element_text(angle = 90))+
scale_fill_d3()
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.7)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
facet_grid(ca_Geography~.)
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.7)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
facet_grid(ca_Geography~.)+
theme(legend.position='none')+
scale_fill_d3()
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.9)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
facet_grid(ca_Geography~.)+
theme(legend.position='none')+
scale_fill_d3()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1, color="red")+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.9)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
theme_bw()+
facet_grid(ca_Geography~.)+
theme(legend.position='none')+
scale_fill_d3()
medias<-dat %>%
select(ca_Geography,cu_EstimatedSalary) %>%
group_by(ca_Geography) %>%
summarise(mean=mean(cu_EstimatedSalary))
ggplot(dat, aes(ca_Geography,cu_EstimatedSalary,fill=ca_Geography))+
geom_boxplot()+
geom_point(data=medias,aes(ca_Geography,mean),shape=8)+
geom_line(data=medias,aes(ca_Geography,mean), group=1, color="red")+
theme_bw()+
theme(legend.position='none')+
scale_fill_jco()
dat %>%
ggplot(aes(cu_EstimatedSalary, fill = ca_Geography, alpha=0.9)) +
geom_density(kernel = "gaussian") +
geom_vline(data = dat %>%
group_by(ca_Geography) %>%
summarise(mean= mean(cu_EstimatedSalary)),
aes(xintercept = mean))+
stat_overlay_normal_density(color = "red", linetype = "dashed")+
theme_bw()+
facet_grid(ca_Geography~.)+
theme(legend.position='none')+
scale_fill_d3()
