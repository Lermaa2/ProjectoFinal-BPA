facet_wrap(.~variable, scales = "free")+
theme_bw()
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
theme(legend.position='none')+
facet_wrap(.~variable, scales = "free")+
theme_bw()
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
```{r,fig.height = 3}
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
```{r,fig.height = 4.5, message=FALSE}
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
dat <-  dat %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard),
factor))
##* Para `CreditCat`:
dat$CreditCat <- factor(dat$CreditCat,
labels = c("poor", "fair",
"good", "very_good",
"excellent"),ordered = T);glimpse(dat)
##* Se crea ademas formato canónico de la tabla de datos, es decir, que tiene una
##* fila para cada valor observado (medido).
dat_long = melt(dat);glimpse(dat_long)
dat_long %>%
select(variable,value)
dat_long %>%
group_by(!is.numeric(dat_long))
dat_long %>%
select(!is.numeric(dat_long))
dat_long %>%
select(!is.numeric())
dat_long %>%
select(!is.numeric(dat_long))
dat_long %>%
select(where(is.numeric))
dat_long %>%
select(where(!is.numeric))
dat_long %>%
select(!where(is.numeric))
dat_long %>%
select(!where(is.numeric) & !variable)
dat_long %>%
select(Geography,Gender, IsActiveMember,HasCrCard,CreditCat)
dat %>%
rename_if(is.numeric,~paste("cu",names(),sep = "_") )
dat %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") )
dat %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(!is.numeric,~paste("ca",.x,sep = "_") )
dat %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(negate(is.numeric),~paste("ca",.x,sep = "_") )
dat <-  dat %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard),
factor)) %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(negate(is.numeric),~paste("ca",.x,sep = "_") )
dat %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard),
factor))
dat <-  data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard),
factor)) %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(negate(is.numeric),~paste("ca",.x,sep = "_") )
View(dat)
data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts)
data_ori[2:13]
glimpse(dat)
dat <-  data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard,
CreditCat),
factor)) %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(negate(is.numeric),~paste("ca",.x,sep = "_") )
##* Para `CreditCat`:
dat$ca_ <- factor(dat$CreditCat,
labels = c("poor", "fair",
"good", "very_good",
"excellent"),ordered = T);glimpse(dat)
##* Para `CreditCat`:
dat$CreditCat <- factor(dat$CreditCat,
labels = c("poor", "fair",
"good", "very_good",
"excellent"),ordered = T);glimpse(dat)
data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0))
data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts)
data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard,
CreditCat),
factor))
data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard,
CreditCat),
factor)) %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") )
data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard,
CreditCat),
factor)) %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(negate(is.numeric),~paste("ca",.x,sep = "_") )
dat <-  data_ori[2:13] %>%
mutate( CreditCat= case_when(CreditScore < 580 ~ 1,
CreditScore >= 580 & CreditScore < 669 ~ 2,
CreditScore >= 669 & CreditScore < 739 ~ 3,
CreditScore >= 739 & CreditScore < 799 ~ 4,
CreditScore >= 799 ~ 5,
TRUE ~ 0)) %>%
select(CustomerId, Surname,Geography,Gender,
IsActiveMember, HasCrCard, CreditCat,
CreditScore, Age, EstimatedSalary, Tenure ,
Balance, NumOfProducts) %>%
mutate(across(c(CustomerId,
Surname,
Geography,
Gender,
IsActiveMember,
HasCrCard,
CreditCat),
factor)) %>%
rename_if(is.numeric,~paste("cu",.x,sep = "_") ) %>%
rename_if(negate(is.numeric),~paste("ca",.x,sep = "_") )
##* Para `CreditCat`:
dat$CreditCat <- factor(dat$CreditCat,
labels = c("poor", "fair",
"good", "very_good",
"excellent"),ordered = T);glimpse(dat)
##* Para `CreditCat`:
dat$ca_CreditCat <- factor(dat$ca_CreditCat,
labels = c("poor", "fair",
"good", "very_good",
"excellent"),ordered = T);glimpse(dat)
##* Se crea ademas formato canónico de la tabla de datos, es decir, que tiene una
##* fila para cada valor observado (medido).
dat_long = melt(dat);glimpse(dat_long)
dat_long %>%
select(starts_with("ca" & !ca_Surname))
dat_long %>%
select(starts_with("ca" & !ca_Surname))
dat_long %>%
select(starts_with("ca") & !ca_Surname)
dat_long %>%
select(starts_with("ca") & !ca_Surname) %>%
summary()
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
summary()
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
summary()
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(ca_Geography)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(ca_Geography,name_to=ca_Geography)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(ca_Geography,name_to="ca_Geography")
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(ca_Geography)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(everything)
pivot_longer(everything()
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(everything())
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
pivot_longer(!ca_CustomerId)
dat %>%
select(starts_with("ca") & !ca_Surname)
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId) %>%
melt()
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId) %>%
melt(every())
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId) %>%
pivot_longer(ca_Geography)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId) %>%
pivot_longer(ca_Geography) %>%
pivot_longer(ca_IsActiveMember)
##* Graficos, al ser categoricas, se utilizan barras
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId) %>%
pivot_longer(ca_Geography)
dat %>%
select(starts_with("ca") & !ca_Surname & !ca_CustomerId)
##* Frecuencias
dat %>%
select(starts_with("ca") & !ca_Surname) %>%
summary()
summary(dat[8:13]);
## Mas estadisticos básicos
describe(dat[8:13])
class(summary(dat[8:13]))
summary(dat[8:13]);glimpse(summary(dat[8:13]))
glimpse(summary(dat[8:13]))
summary.data.frame(dat[8:13])
summary.lm(dat[8:13])
Summary.data.frame(dat[8:13])
Summary.data.frame(dat[8:13])
summary.data.frame(dat[8:13])
summary.table(dat[8:13])
summary.data.frame(dat[8:13])
## Mas estadisticos básicos
describeFast(dat[8:13])
## Mas estadisticos básicos
describeData(dat[8:13])
## Mas estadisticos básicos
describe(dat[8:13])
summary.data.frame(dat[8:13])
## Mas estadisticos básicos
describe(dat[8:13])
summary.data.frame(dat[starts_with("cu")])
dat %>%
select(starts_with("cu")) %>%
summary.data.frame()
## Mas estadisticos básicos
dat %>%
select(starts_with("cu")) %>%
describe()
dat %>%
select(starts_with("cu")) %>%
summary.data.frame()
## Mas estadisticos básicos
dat %>%
select(starts_with("cu")) %>%
describe()
dat %>%
select(starts_with("cu")) %>%
summary.data.frame()
## Mas estadisticos básicos
dat %>%
select(starts_with("cu")) %>%
describe()
## Grafica
dat_long %>%
ggplot(aes(variable, value,fill=variable))+
geom_boxplot()+
geom_point(data=dat_long %>%
group_by(variable) %>%
summarise(mean= mean(value)),
aes(variable,mean), shape=8)+
facet_wrap(.~variable, scales = "free")+
theme_bw()+
theme(legend.position='none')
## Mas estadisticos básicos
dat %>%
select(starts_with("cu")) %>%
describe()
dat %>%
select(starts_with("cu"))
dat %>%
select(starts_with("cu")) %>%
summarise(across(everything(),ks.test(.,"pnorm")))
ks.test(dat$cu_CreditScore,"pnorm")
x <- ks.test(dat$cu_CreditScore,"pnorm")
View(x)
dat %>%
select(starts_with("cu")) %>%
summarise(across(everything(),ks.test(.,"pnorm")$p.value))
dat %>%
select(starts_with("cu")) %>%
summarise(across(everything(),~ks.test(.,"pnorm")$p.value))
ks.test(dat$cu_CreditScore,"pnorm")$p.value
ks.test(dat$cu_CreditScore,"pnorm")
dat %>%
select(starts_with("cu")) %>%
summarise(across(everything(),~ks.test(.,"pnorm")$p.value))
ks.test(dat$cu_EstimatedSalary,"pnorm")$p.value
ks.test(dat$cu_EstimatedSalary,"pnorm")
dat %>%
select(starts_with("cu")) %>%
summarise(across(everything(),~ks.test(.,"pnorm")$p.value))
View(x)
